# é–‹ç™ºç’°å¢ƒã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã¨åŸºæœ¬æ“ä½œ

## ðŸš€ é–‹ç™ºç’°å¢ƒã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

### å¿…è¦æ¡ä»¶

- Docker ã¨ Docker Compose
- Git

### ã‚¯ã‚¤ãƒƒã‚¯ã‚¹ã‚¿ãƒ¼ãƒˆ

1. ãƒªãƒã‚¸ãƒˆãƒªã‚’ã‚¯ãƒ­ãƒ¼ãƒ³:
   ```bash
   git clone git@github.com:your-organization/eventa.git
   cd eventa
   ```

2. ç’°å¢ƒã‚’èµ·å‹•:
   ```bash
   make dev
   ```
   ã“ã‚Œã«ã‚ˆã‚Šã€ä»¥ä¸‹ã®å‡¦ç†ãŒå®Ÿè¡Œã•ã‚Œã¾ã™:
   - Dockerã‚³ãƒ³ãƒ†ãƒŠã®ãƒ“ãƒ«ãƒ‰ã¨èµ·å‹•
   - ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®æº–å‚™ (ãƒžã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã¨ã‚·ãƒ¼ãƒ‰)
   
3. ã‚µãƒ¼ãƒ“ã‚¹ã®ç¢ºèª:
   - API: http://localhost:3001/healthz
   - API Routes: http://localhost:3001/rails/info/routes (é–‹ç™ºç’°å¢ƒã®ã¿)
   - ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰: http://localhost:3000 (å®Ÿè£…å¾Œ)

### åˆ©ç”¨å¯èƒ½ãªã‚³ãƒžãƒ³ãƒ‰

Makefileã‚’ä½¿ç”¨ã—ã¦ä¸€èˆ¬çš„ãªã‚¿ã‚¹ã‚¯ã‚’å®Ÿè¡Œã§ãã¾ã™:

```bash
make help      # åˆ©ç”¨å¯èƒ½ãªã‚³ãƒžãƒ³ãƒ‰ä¸€è¦§
make dev       # é–‹ç™ºç’°å¢ƒã‚’èµ·å‹•
make reset-db  # ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’ãƒªã‚»ãƒƒãƒˆ
make lint      # ã‚³ãƒ¼ãƒ‰å“è³ªãƒã‚§ãƒƒã‚¯ (Standardã‚’ä½¿ç”¨)
make test      # ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œ
make ci        # lintã¨testã‚’é€£ç¶šå®Ÿè¡Œ
```

### æœ¬ç•ªç’°å¢ƒã«è¿‘ã„æ§‹æˆã§ã®èµ·å‹•

Workerãƒ—ãƒ­ã‚»ã‚¹ã‚’åˆ†é›¢ã—ã¦èµ·å‹•ã™ã‚‹å ´åˆã¯ã€ä»¥ä¸‹ã®ã‚³ãƒžãƒ³ãƒ‰ã‚’ä½¿ç”¨ã—ã¾ã™:

```bash
docker compose --profile production-like up
```

ã“ã®ã‚³ãƒžãƒ³ãƒ‰ã¯ã€APIã¨Workerãƒ—ãƒ­ã‚»ã‚¹ã‚’åˆ¥ã€…ã®ã‚³ãƒ³ãƒ†ãƒŠã§å®Ÿè¡Œã—ã€æœ¬ç•ªç’°å¢ƒã«è¿‘ã„æ§‹æˆã‚’ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã—ã¾ã™ã€‚

## ðŸ”§ é–‹ç™ºç’°å¢ƒã®ä»•æ§˜

- **Ruby**: 3.3
- **Rails**: 8.0
- **ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹**: MySQL 8.0
- **ã‚­ãƒ£ãƒƒã‚·ãƒ¥/ã‚¸ãƒ§ãƒ–**: Redis 7 + Sidekiq
- **ã‚³ãƒ¼ãƒ‰å“è³ª**: Standard (Rubocopãƒ™ãƒ¼ã‚¹ã®çµ±ä¸€ã‚¹ã‚¿ã‚¤ãƒ«)

## ðŸ“ GitHub Codespaces / Dev Container å¯¾å¿œ

ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¯Dev Containerã«å¯¾å¿œã—ã¦ãŠã‚Šã€VSCode Dev Containersã¾ãŸã¯GitHub Codespacesã§ã®é–‹ç™ºã‚’ã‚µãƒãƒ¼ãƒˆã—ã¦ã„ã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒã®è¨­å®šãªã—ã«é–‹ç™ºã‚’å§‹ã‚ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

1. ãƒªãƒã‚¸ãƒˆãƒªã‚’GitHubã‹ã‚‰ã‚¯ãƒ­ãƒ¼ãƒ³
2. VSCodeã§ã€ŒOpen in Containerã€ã¾ãŸã¯ã€ŒOpen in Codespaceã€ã‚’é¸æŠž
3. è‡ªå‹•çš„ã«é–‹ç™ºç’°å¢ƒãŒã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã•ã‚Œã¾ã™

## ðŸ§ª ãƒ†ã‚¹ãƒˆ

RSpecã‚’ä½¿ç”¨ã—ã¦ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œ:

```bash
make test
```

ã‚³ãƒ¼ãƒ‰å“è³ªãƒã‚§ãƒƒã‚¯:

```bash
make lint
```

> **æ³¨æ„**: ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ã¯ã€Rubocopã®ç›´æŽ¥ä½¿ç”¨ã§ã¯ãªãã€Standardã‚’æŽ¡ç”¨ã—ã¦ã„ã¾ã™ã€‚Standardã¯ä¸€è²«ã—ãŸã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚¹ã‚¿ã‚¤ãƒ«ã‚’é©ç”¨ã™ã‚‹Rubocopãƒ™ãƒ¼ã‚¹ã®ãƒ„ãƒ¼ãƒ«ã§ã€è¨­å®šã®è¤‡é›‘ã•ã‚’è»½æ¸›ã—ã¾ã™ã€‚`make lint`ã‚³ãƒžãƒ³ãƒ‰ã¯Standardã‚’å®Ÿè¡Œã—ã¾ã™ã€‚

## â“ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

- **API 502 ã‚¨ãƒ©ãƒ¼**: MySQLã®èµ·å‹•å‰ã«RailsãŒç«‹ã¡ä¸ŠãŒã£ãŸå¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚`docker compose restart api`ã§è§£æ±ºã—ã¾ã™ã€‚
- **ä¾å­˜é–¢ä¿‚ã®ã‚¨ãƒ©ãƒ¼**: `make dev`ã‚’å†å®Ÿè¡Œã™ã‚‹ã‹ã€`docker compose exec api bundle install`ã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„ã€‚

### macOSï¼ˆç‰¹ã«Apple Siliconï¼‰ã§ã®mysql2 gemä¾å­˜é–¢ä¿‚

macOSãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒã§`bundle install`ã‚’å®Ÿè¡Œã™ã‚‹å ´åˆã€mysql2 gemãŒMySQLã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãƒ˜ãƒƒãƒ€ã‚’è¦‹ã¤ã‘ã‚‰ã‚Œãšã«ã‚¨ãƒ©ãƒ¼ã«ãªã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚è§£æ±ºæ–¹æ³•ã¯ã„ãã¤ã‹ã‚ã‚Šã¾ã™ï¼š

#### çŽ‹é“ã®è§£æ±ºç­–ï¼ˆæŽ¨å¥¨ï¼‰ï¼š

```bash
# 1) ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
brew install mysql@8 openssl@3

# 2) PATHã‚’é€šã™
echo 'export PATH="/opt/homebrew/opt/mysql@8/bin:$PATH"' >> ~/.zprofile
source ~/.zprofile

# 3) mysql2ãƒ“ãƒ«ãƒ‰è¨­å®šã‚’è¿½åŠ 
bundle config --local build.mysql2 \
  "--with-mysql-dir=$(brew --prefix mysql@8) \
   --with-openssl-dir=$(brew --prefix openssl@3)"
``` 