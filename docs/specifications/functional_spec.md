# Eventa — 機能仕様書

**作成者**: プラットフォームチーム  
**ステータス**: Draft v0.1  
**最終更新日**: 2025-04-30  
**機密**: 社内利用限定

## 1. 概要
Eventa はオンライン／オフラインを問わず "誰でもカンタンにイベント立ち上げ & チケット販売" を実現する SaaS プラットフォーム。目的は主催者の販売オペレーションと参加者の来場体験を極小コストで最適化することにある。

**🎯 一言で**: 「Stripe Checkout の UX と Peatix のコミュニティ要素を足して 3 で割り、CI/CD 並みにスピーディに回るイベント基盤」

## 2. ビジョンと目標

| 目標 | メトリクス (M30) |
|------|----------------|
| 主催者が 10 分以内に販売開始 | 初回イベント公開までの平均所要時間 < 10 分 |
| 決済完了率を最大化 | 決済失敗率 < 0.7 % (国内)、< 1.2 % (海外) |
| 来場者の行列時間をゼロへ | 入場処理時間 < 1 秒/人 |
| 満足度の高いイベント体験 | NPS > 60 |

## 3. ユーザーペルソナ

### 主催者 (Organizer)
- 年1回の社内イベント・コミュニティ運営者
- 月に1-2回の小中規模セミナー開催
- 少人数の運営チームで費用対効果重視

### 参加者 (Attendee)
- 20-40代のモバイルネイティブ層
- 決済はクレジットカード/モバイル決済が主流
- 長蛇の列、紙の印刷、現金払いを避けたい
- 複数のSNSアカウントを使い分け

## 4. 主要機能一覧

### FR-01: チケットタイプ管理
- 複数料金・複数在庫の設定
- 販売時間と在庫による自動ステータス更新
- 価格と説明文のカスタマイズ
- 無料/有料のハイブリッド設定

### FR-02: 決済処理
- クレジットカード決済 (Stripe)
- コンビニ払い・銀行振込 (Pay.jp)
- 購入完了メール自動送信
- 決済エラー時のリカバリーフロー

### FR-03: QRチケット管理
- QRコード自動生成・メール送付
- チケットステータス管理 (発行済/使用済/キャンセル)
- マイページでのチケット確認
- チケット譲渡機能 (Phase 2)

### FR-04: 会場受付
- スマホカメラでのQRスキャン
- オフラインモード対応 (キャッシュ)
- リアルタイム入場管理ダッシュボード
- 入場禁止リスト管理

### FR-05: 座席管理
- 座席マップエディタ (ドラッグ&ドロップ)
- 座席の個別/一括ブロック
- 販売状況のヒートマップ表示
- 座席タイプ別の料金設定

### FR-06: 通知・リマインダー
- イベント前日リマインダー
- 変更・中止時の一括通知
- 通知テンプレートカスタマイズ
- チャネル (メール/LINE/Slack) 選択

### FR-07: 管理ダッシュボード
- リアルタイム販売状況
- 財務レポート (売上・手数料・返金)
- アクセス解析 (流入元/コンバージョン)
- 参加者データ分析 (属性/地域)

## 5. 機能詳細

### FR-01: チケットタイプ管理

#### 背景・目的
イベント主催者が複数種類のチケットをシンプルに設定・販売できるようにする。Early Birdや学生割引、スポンサー枠など多様な料金体系をサポートし、時間経過と在庫状況に応じた自動ステータス更新を実現する。

#### ユーザーストーリー
1. 主催者として、複数の料金プランと販売期間を設定したい
2. 主催者として、各チケットタイプの販売状況をリアルタイムで確認したい
3. 参加者として、自分に適したチケットタイプを比較して選びたい

#### 機能要件
- チケットタイプの新規作成・編集・削除
- 各タイプに名称・説明・価格・数量・販売期間を設定
- 販売状況に応じたステータス表示 (準備中/販売中/売切れ/終了)
- チケットタイプごとの購入条件設定 (特定コード所持者のみ等)

#### 技術要件
- チケットタイプステータスは DB/Redis での在庫管理と時刻計算で自動更新
- 購入時の在庫確保は悲観的ロックで二重販売を防止
- 決済未完了の一時在庫確保は最大15分で自動開放

#### 画面仕様
**チケットタイプ一覧画面**
- テーブル形式で各タイプの基本情報表示
- 販売状況をカラーコードでビジュアル化
- 各行に編集・無効化・複製などのアクション

**チケットタイプ編集モーダル**
- タブ形式で基本情報/詳細設定/表示設定を分離
- プレビューパネルで購入者向け表示を確認
- 保存前の入力検証 (価格・数量・期間の整合性)

### FR-02: 決済処理

#### 背景・目的
スムーズな購入体験と高い決済完了率を実現する決済基盤を提供する。国内外の主要決済手段をサポートし、決済エラー時の適切なフォールバック処理でユーザー離脱を最小化する。

#### ユーザーストーリー
1. 参加者として、多様な決済手段から選んで支払いたい
2. 参加者として, 決済エラー時に何が起きたか理解し、代替手段を試したい
3. 主催者として、決済状況と売上をリアルタイムで把握したい

#### 機能要件
- Stripe Connect によるクレジットカード決済
- Pay.jp によるコンビニ払い・銀行振込対応
- 決済完了→チケット発行の自動フロー
- 決済エラー時のメッセージとリカバリーオプション提示
- 売上レポートと入金管理

#### 技術要件
- PCI DSS 対応のため、カード情報は自社サーバーに保存しない方式
- Webhook によるステータス更新の非同期処理
- 決済処理のリトライとエラーログ収集
- 定期的な整合性チェックバッチによる不整合検出

#### 画面仕様
**決済選択画面**
- 主要カードブランドのロゴ表示
- コンビニ/銀行振込のオプション (手数料表示)
- 金額内訳 (小計/税/手数料/合計)

**決済完了/エラー画面**
- 成功時: チケット情報とQRコード表示、メール送信
- エラー時: 具体的なエラー理由と次のアクション提案 