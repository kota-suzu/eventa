# eventa テスト計画書 (v0.1)

**作成日**: 2025-04-30  
**対象バージョン**: v0.1.0 (MVP Alpha)  
**作成者**: QAチーム  
**参照規格**: IEEE 829 / ISO 29119

## 目的
本書は eventa の品質保証活動を計画し、テストの範囲・方法・責任・スケジュール・基準を定義することで、サービスレベル目標 (P95 < 300 ms, エラー率 < 0.1 %) を満たすことを目的とする。

## 背景
年 1 回・1,000 名規模イベントの本番利用に向け、MVP Alpha をステージング環境で内部パイロット中。
本版での主要リスク: 決済障害、QR 受付遅延、座席二重販売。

## テスト対象 (Test Items)

| モジュール | 主な機能 |
|----------|---------|
| チケット | タイプ作成、購入、QR 発行、キャンセル |
| 決済 | Stripe / Pay.jp 決済フロー、リトライ、Webhook 処理 |
| 受付 | QR スキャン、チェックイン API、オフライン fallback |
| 座席 | 座席マップ編集、在庫ロック、開放 |
| 通知 | メール / LINE / Slack 送信、テンプレート切替 |
| 管理レポート | 売上集計、来場者分析、イベント比較 |

## テスト種類と方法

### 1. 単体テスト (Unit Tests)
- **担当**: 各開発者
- **ツール**: RSpec (API), Jest (Frontend)
- **自動化**: GitHub Actions で PR 時に実行
- **カバレッジ目標**: 80% 以上

### 2. 統合テスト (Integration Tests)
- **担当**: バックエンドチーム
- **対象**: API エンドポイント間の連携、DB トランザクション
- **ツール**: RSpec request specs
- **環境**: CI 環境 (テスト用 DB)

### 3. E2E テスト (End-to-End Tests)
- **担当**: QA チーム
- **対象**: 主要ユーザーフロー (チケット購入〜受付完了)
- **ツール**: Cypress
- **環境**: Staging

### 4. パフォーマンステスト
- **担当**: SRE チーム
- **対象**: API レスポンス時間、同時接続耐性
- **ツール**: k6, New Relic
- **基準**: P95 < 300ms, 最大同時接続 1,000

### 5. セキュリティテスト
- **担当**: セキュリティチーム
- **対象**: 認証・認可、入力検証、決済フロー
- **ツール**: OWASP ZAP, Burp Suite
- **頻度**: 四半期に1回、機密機能変更時

## テスト環境

| 環境 | 用途 | アクセス | データ |
|-----|------|---------|-------|
| Dev | 開発者テスト | 開発者のみ | サンプルデータ |
| CI | 自動テスト | GitHub Actions | テストフィクスチャ |
| Staging | QA、受入テスト | 社内のみ | 匿名化した本番相当 |
| Production | モニタリング | 全ユーザー | 本番データ |

## テスト実施計画

### フェーズ 1: 内部テスト (2週間)
1. **単体テスト**: 全モジュール (開発者)
2. **API テスト**: エンドポイント全数確認 (QA)
3. **決済テスト**: Stripe テストモードで検証 (開発・QA)

### フェーズ 2: 統合テスト (1週間)
1. **E2E フロー**: 主要ユーザージャーニー
2. **エラーケース**: 回復性・エラーハンドリング
3. **パフォーマンス**: 基本負荷テスト

### フェーズ 3: 受入テスト (1週間)
1. **UAT**: 社内ステークホルダーによる検証
2. **セキュリティ**: ぜい弱性スキャン
3. **アクセシビリティ**: WCAG 2.1 AA 準拠確認

### フェーズ 4: パイロット運用 (4週間)
1. **モニタリング**: 実使用状況の監視
2. **バグ修正**: 発見された問題の迅速な対応
3. **パフォーマンス最適化**: ボトルネック対策

## テスト成果物

| 成果物 | 概要 | 責任者 |
|-------|------|-------|
| テスト計画書 | 本書 | QA リード |
| テストケース | Jira Test Plans | QA チーム |
| 自動テストコード | GitHub リポジトリ | 開発者 + QA |
| 不具合レポート | Jira Issues | 発見者 |
| テスト結果報告書 | リリース前最終評価 | QA リード |

## 品質評価基準・出口基準

### 必須条件 (Must)
1. 全ての Critical/High バグが解消されていること
2. 単体テストカバレッジ 80% 以上
3. 主要ユーザーフローが E2E テストでパスすること
4. セキュリティスキャンで Critical 指摘がないこと
5. P95 レイテンシ < 300ms (目標負荷時)

### 望ましい条件 (Should)
1. Medium バグが 5 件以下
2. アクセシビリティ警告が 0 件
3. フロントエンドの Lighthouse スコア > 90

## 不具合管理プロセス

### 優先度定義
- **P1 (Critical)**: サービス提供不能、データ損失リスク
- **P2 (High)**: 主要機能の障害、回避策なし
- **P3 (Medium)**: 機能の一部制約、回避策あり
- **P4 (Low)**: 軽微な問題、UX 向上の余地

### 対応期限
- P1: 即時対応 (24 時間以内に修正)
- P2: 次回リリースで対応
- P3: 2 サイクル以内に対応
- P4: バックログ管理

## リスクと対策

| リスク | 対策 |
|-------|------|
| 決済障害 | Stripe テストモードで全パターン検証、Webhook シミュレータ利用 |
| 受付遅延 | JMeter で同時アクセステスト、オフラインモード検証 |
| 二重販売 | 悲観的ロックのユニットテスト、同時購入シナリオ検証 |
| QR 読取不良 | 異なる端末・照明条件での検証、エラー処理確認 |

## まとめ
本テスト計画は MVP リリースに向けた品質保証活動の指針となるもので、随時見直しを行い改善していく。
特に決済と受付機能についてはユーザー体験の核となる部分として重点的にテストを実施する。 